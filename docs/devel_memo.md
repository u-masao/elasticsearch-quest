# elasticsearch-quest


## 開発フロー


要件定義支援
Gemini 2.5 pro Gems

```
# キャラクター

あなたはコンピューターの専門家です。高速にプロトタイプアプリを開発することが得意です。


# 目的と用途

ユーザーの希望を聞いてプロトタイプソフトウェアの仕様、アーキテクチャ、コア技術を決めて下さい。


# タスク

ヒアリングして要求仕様、要件、利用するコア技術を明文化し、ユーザーの同意を得ます。

プロトタイプなので非機能要件は重視しません。
```



```
 Elasticsearch のクエリ作成方法を学ぶアプリを作りたい。作り方を考えて
```

 アプリの名前はElasticsearch Quest です。ステップ　by ステップで小さなクエストをクリアさせます。クエストはクエリの目的をユーザーに提示して、ユーザーが正しいクエリを作れるまで終わらないものです。タイムアウトやヒントがあってもよい。

  アーキテクチャはアイディアがあります。フロントエンドはgradio 、ai エージェント管理とフロー制御とllm のアクセスはopenai agents sdk 。elasticsearch とllm のやりとりはmcp。状態管理はsqlite 。

 LLMの主な役割ば、学習ロードマップの生成、問題の生成、ヒント生成、ユーザーが作ったクエリの出力の正誤判定の定性評価、クエリの定性評価、更なる改善のヒント生成、クエストポイントの生成です。コストは気にしませんが計測はしたい。速度は気にしない。sqlite の用途はユーザーのステイタス管理、過去の問題と回答内容と正誤と速度。結果の定量評価は正解と不正解だけではなくnDCG みたいなランキング精度もみます


 フェーズ4 にユーザーを応援する画像も生成しましょう。その他、ゲーム性を高める演出を考えます 

 コスト取得はopenai agents sdk の機能で可能です。tiktoken で事前に計算する必要はありません。 

  コア機能にサンプルデータの生成を追加


 データはアプリとして固定しましょう。友達と教えあいやすくなります 


## サンプルデータの生成

fixtures/sample_books.json

```
日本のデータサイエンティストが好きそうな書籍を20冊列挙して。
JSON 形式で記載して。わからないものは適当なもので埋めて。

name: 書名
author: 著者
publisher: 出版社
isbn: isbn 番号
pages: ページ数
metric_vector: [technical theme, mathematical theme] 内容の傾向を 0 から 10 で表したベクトル
```


## スキーマ作成

```
クエスト定義:
フェーズ1で扱う基本的なElasticsearchクエリ（match, term, range, bool等）に対応するクエストを5〜10個程度具体化する。
各クエストの問題文、期待される結果（ヒット件数、特定ドキュメント等）、基本的な評価基準、ヒントの素案を定義する。
定義したクエスト情報をSQLiteデータベース等に格納する形式を決定し、実装する。

このタスクを進めます。ｓｑｌｉｔｅのスキーマを考えて。
```

## サンプルクエスト作成


```
サンプルデータに合わせて　Quest を作って。

- ベクトルフィールドの意味
  - Elasticsearch のスキーマは L2 距離でベクトル検索可能
  - metric_vector[0] は Technical score
  - metric_vector[1] は Mathematical Score
```
